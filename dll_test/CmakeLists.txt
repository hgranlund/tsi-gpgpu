# Append current NVCC flags by something, eg comput capability

include_directories(
  ${CMAKE_CURRENT_SOURCE_DIR}
  )



include (GenerateExportHeader)

set(HFILES_PUBLIC
  hello.h
  )

set(GENCODE -gencode=arch=compute_20,code=sm_20 -gencode=arch=compute_20,code=compute_20)


if (CUDA_VERBOSE_PTXAS)
  set(VERBOSE_PTXAS --ptxas-options=-v)
endif (CUDA_VERBOSE_PTXAS)

set(CMAKE_CXX_VISIBILITY_PRESET hidden)
set(CMAKE_VISIBILITY_INLINES_HIDDEN 1)

cuda_add_library(hello ${LIB_TYPE}
  hello.cu
  hello.h
  OPTIONS ${GENCODE} ${VERBOSE_PTXAS}
  )

generate_export_header(hello)

install(FILES hello.h hello.cu
  ${PROJECT_BINARY_DIR}/dll_test/hello_export.h
  DESTINATION include
  )

install(TARGETS hello
  DESTINATION lib
  EXPORT hello-targets
  )

install(EXPORT hello-targets
  DESTINATION lib
  )



link_directories(
  ${CMAKE_SOURCE_DIR}/lib/
)

cuda_add_executable(hello_world
  hello_world.cu
)

  target_link_libraries(hello_world hello)
  add_custom_target(hello-world hello_world)


